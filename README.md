# SkimaLens 👁️‍🗨️

**隙間（すきま）を覗くLens - データの向こう側を見通すツール**

ClaudeやChatGPTの会話ログをはじめとした、JSONやYAMLデータを可視化するためのWebベースデータビューアツールです。

## 🎯 コンセプト

**「隙間を覗く」**という名前の通り、SkimaLensはデータの表面的な構造の奥にある本質的な情報を見つけ出すことを目的としています。

- **🔍 データの隙間**: 複雑なJSON構造の中に隠れた意味のある情報を発見
- **💬 会話の隙間**: 対話ログの行間に存在する思考のプロセスや文脈を可視化  
- **⏰ 時間の隙間**: メッセージ間の時間差から見えるコミュニケーションのリズム
- **🗂️ 削除の隙間**: 削除されたデータが残す痕跡から全体像を推測

現代のデータ分析では、表面的な数値や文字列だけでなく、その**「間」**や**「欠損」**にこそ重要な意味が隠されています。SkimaLensは、そんな見落としがちな「隙間」にフォーカスを当てた新しいアプローチのデータビューアです。

## 概要

SkimaLensは、構造化データを読み込んで直感的に参照・可視化できるフロントエンド専用ツールです。データの「隙間」を見つけ、意味のある洞察を得ることができます。

### 🎯 主な用途

#### ✅ 現在サポート中
- **💬 Claudeの会話ログ分析**: conversation.jsonファイルの詳細表示
  - 削除済み会話の検出と可視化
  - メッセージ間の時間軸分析
  - 会話の流れと文脈の理解
  - ファイル添付・フィードバック情報の表示

- **🤖 ChatGPTの会話ログ分析**: エクスポートファイルの完全サポート ✨ **NEW!**
  - 会話のツリー構造を時系列に平坦化
  - ユーザーとアシスタントのメッセージを明確に区別
  - 豊富なメタデータ（作成・更新日時、会話ID等）の表示
  - Claude形式との統一されたインターフェース

#### 🔮 今後の展開予定
- **📊 CloudWatchログ**: システムログの可視化と分析
- **🗂️ 汎用JSON/YAMLデータ**: 自由形式のデータ探索
- **📈 高度な分析機能**: 会話パターンの統計分析、ワードクラウド生成

### ✨ 特徴

- **🚀 高速 & 軽量**: バックエンド不要のフロントエンド専用ツール
- **📁 簡単操作**: ドラッグ&ドロップまたはファイル選択で即座に分析開始
- **🎨 美しいUI**: TypeScript + React + Shadcn/UIによる洗練されたインターフェース
- **🔍 高度な検索**: リアルタイム全文検索・フィルタリング・ソート機能
- **🗃️ スマートフィルタ**: 削除されたデータやエラーログの自動検出
- **📱 レスポンシブ**: デスクトップからモバイルまで対応
- **🔒 プライバシー保護**: データはブラウザ内でのみ処理、外部送信なし

## 🚀 クイックスタート

### 💻 CLI使用（推奨）

SkimaLensはコマンドラインツールとして使用できます：

```bash
# ファイル指定なし（アップロード画面）
pnpx @infodb/skimalens

# ファイル指定あり（直接ビューアー起動）
pnpx @infodb/skimalens /path/to/conversation.json
pnpx @infodb/skimalens /path/to/chatgpt-export.json
pnpx @infodb/skimalens /path/to/data.yaml
```

#### CLI特徴
- **🚀 独立したWebサーバー**: rsbuild/pnpmに依存しない軽量サーバー
- **📁 直接ファイルアクセス**: ローカルファイルを安全に読み込み
- **🌐 自動ブラウザ起動**: VSCode環境でも適切に対応
- **⚡ 高速起動**: 必要最小限の依存関係で即座に開始
- **🛑 グレースフルシャットダウン**: Ctrl+Cで確実にサーバー停止

### 🛠️ 開発者向け

```bash
# 依存関係をインストール
pnpm install

# 開発サーバーを起動 (通常はポート8080)
pnpm run dev

# 本番用ビルド
pnpm run build

# CLIをローカルで実行
pnpm run cli [ファイルパス]
```

## 🛠️ 技術スタック

| 分野 | 技術 | 説明 |
|------|------|------|
| **Language** | TypeScript | 完全型安全な開発環境 |
| **Frontend** | React 19 + TypeScript | 型安全性を重視したモダンフロントエンド |
| **Build** | Rsbuild (Rspack) | 高速ビルドツール |
| **CLI Server** | Node.js HTTP Server | 独立した軽量Webサーバー |
| **Routing** | TanStack Router | ファイルベースルーティング with 型安全性 |
| **UI Framework** | Shadcn/UI + Tailwind CSS | 美しく一貫性のあるデザインシステム |
| **Icons** | Lucide React + Radix UI Icons | 豊富で軽量なアイコンセット |
| **File Processing** | js-yaml + react-dropzone | ファイル解析とアップロード処理 |
| **Package Manager** | pnpm | 高速で効率的な依存関係管理 |

## 🎨 使い方

### 基本操作

#### 🖥️ CLI使用時
1. **ファイル指定**: コマンドライン引数でファイルパスを指定
2. **自動起動**: ブラウザが自動で開き、即座にデータが読み込まれる
3. **データ探索**: 左サイドバーで会話一覧を確認、右ペインで詳細を表示
4. **終了**: Ctrl+Cでサーバーを停止

#### 🌐 Webアプリ使用時
1. **ファイルをアップロード**: ドラッグ&ドロップまたはファイル選択でJSON/YAMLファイルを読み込み
2. **データを探索**: 左サイドバーで会話一覧を確認、右ペインで詳細を表示
3. **隙間を発見**: フィルタ機能で削除済みデータや特定のパターンを発見
4. **洞察を得る**: 検索・フィルタリング機能でデータの奥にある意味を見つける

### サポートファイル形式
- **Claudeの会話ログ**: `conversation.json` (単一または複数の会話)
- **ChatGPTの会話ログ**: エクスポートファイル (単一または複数の会話)
- **汎用データ**: JSON/YAMLファイル

### 主要機能
- **🔍 リアルタイム検索**: メッセージ内容・ID・会話名での即座検索
- **🗂️ スマートフィルタ**: 送信者別（ユーザー/アシスタント）でのメッセージ絞り込み
- **📊 統計表示**: 会話数・メッセージ数・フィードバック数の可視化
- **⏰ 時系列表示**: メッセージの作成・更新日時による並び替え
- **🎯 詳細分析**: メッセージの添付ファイル・フィードバック情報の表示

## 🔄 ChatGPT vs Claude サポート比較

| 機能 | Claude | ChatGPT | 備考 |
|------|--------|---------|------|
| **ファイル形式** | conversation.json | エクスポートJSON | どちらも単一/複数会話対応 |
| **会話メタデータ** | ✅ 名前、UUID、作成/更新日時 | ✅ タイトル、ID、作成/更新日時 | 統一されたインターフェース |
| **メッセージ表示** | ✅ テキスト、時系列 | ✅ テキスト、時系列 | 同じUIで表示 |
| **送信者識別** | ✅ human/assistant | ✅ user/assistant | 自動的にマッピング |
| **添付ファイル** | ✅ ファイル・画像表示 | ❌ エクスポート非対応 | Claude専用機能 |
| **フィードバック** | ✅ 👍👎表示 | ❌ エクスポート非対応 | Claude専用機能 |
| **削除会話検出** | ✅ 空の名前を検出 | ✅ 空のタイトルを検出 | 両方とも対応 |
| **検索・フィルタ** | ✅ 全機能対応 | ✅ 全機能対応 | 完全統一 |

## 🛡️ プライバシーとセキュリティ

- **🔒 完全ローカル処理**: アップロードされたデータはブラウザ内でのみ処理
- **📡 ネットワーク送信なし**: ファイル内容が外部サーバーに送信されることは一切ありません
- **🗑️ セッション限定**: ページをリロードするとデータは完全に削除されます
- **⚡ クライアントサイド分析**: 高速処理と完全なプライバシー保護を両立

## 🔧 トラブルシューティング

### CLI関連

#### ❓ VSCodeでブラウザが開かない
VSCode環境では自動ブラウザ起動がスキップされます。コンソールに表示されるURLを手動でブラウザで開いてください。

#### ❓ Ctrl+Cが効かない
- 1回目のCtrl+C: グレースフルシャットダウン
- 2回目のCtrl+C: 強制終了
- 大きなファイル処理中でも3秒以内に確実に停止します

#### ❓ "Build not found"エラー
```bash
# ビルドを実行してからCLIを使用
pnpm run build
pnpm run cli /path/to/file.json
```

#### ❓ ファイルが見つからない
- 絶対パスまたは相対パスを正確に指定してください
- サポートされているファイル形式: `.json`, `.yaml`, `.yml`

### 一般的な問題

#### ❓ 大きなファイルの処理が遅い
- ファイルサイズが45MB以上の場合、読み込みに時間がかかる場合があります
- 非同期処理により、UIは応答可能な状態を保ちます

#### ❓ 会話が正しく認識されない
- Claude形式: `uuid`, `name`, `chat_messages`フィールドが必要
- ChatGPT形式: `title`, `create_time`, `mapping`フィールドが必要

---

**💡 SkimaLens - データの隙間から真実を見つけ出す新しい体験をお楽しみください**
